
# Denoising Diffusion Probabilistic Models (DDPM) in PyTorch

This repository contains an implementation of **Denoising Diffusion Probabilistic Models (DDPM)**, inspired by the paper "Denoising Diffusion Probabilistic Models" by Jonathan Ho et al. It includes training and sampling methods, along with a U-Net architecture that mimics the design used in modern diffusion models like Stable Diffusion.
Link for the Paper : https://arxiv.org/abs/2006.11239


---

## Introduction

This project demonstrates how **DDPM** can be used for generative modeling of images. It employs a **U-Net architecture** for modeling the reverse diffusion process and uses **MNIST** as the dataset for training and sampling.

---

## Features

- **Training**: Implements the forward diffusion process and trains the reverse process using a U-Net model.
- **Sampling**: Generates images by iteratively reversing the diffusion process.
- **Modular Design**: Easily replace the dataset or tweak the U-Net and noise scheduler configurations.
- **Custom Dataset Support**: Replace MNIST with your own dataset by following the customization steps.

---

## Sample Outputs

Below is an example of images generated by the model after training on the MNIST dataset:

<p align="center">
  <img src="path_to_sample_image.png" width="300" alt="Generated Samples">
</p>

---

## Setup and Installation

1. Clone the repository:
   ```bash
   git clone https://github.com/your-username/DDPM-Pytorch.git
   cd DDPM-Pytorch
   ```

2. Create a new environment (optional but recommended):
   ```bash
   conda create -n ddpm python=3.8 -y
   conda activate ddpm
   ```

3. Install dependencies:
   ```bash
   pip install -r requirements.txt
   ```

---

## Usage

### Data Preparation

1. Convert MNIST CSV files into images:
   ```bash
   python extract_mnist_images.py
   ```
   This script reads `mnist_train.csv` and `mnist_test.csv` to create PNG images in `data/train/images` and `data/test/images`.

2. Ensure the dataset path matches the `default.yaml` configuration.

---

### Training

To train the DDPM model:
```bash
python train_ddpm.py --config config/default.yaml
```

Training outputs:
- **Model Checkpoints**: Saved in `task_name/` as specified in the configuration.
- **Logs**: Training progress will be displayed in the terminal.

---

### Sampling

To generate images from a trained model:
```bash
python sample_ddpm.py --config config/default.yaml
```

Sampling outputs:
- **Generated Images**: Saved in `task_name/samples/*.png`.

---

## Configuration

The project uses a YAML configuration file (`config/default.yaml`) for managing hyperparameters and paths. Key configurable sections include:
- **Dataset Parameters**: Image path and format.
- **Model Parameters**: Number of layers, channels, and embedding dimensions for the U-Net.
- **Training Parameters**: Batch size, learning rate, number of epochs, and checkpoint paths.
- **Diffusion Parameters**: Number of timesteps and beta schedule.

Modify these parameters in the YAML file to suit your needs.

---

## Customization

### Using a Custom Dataset

1. Place your dataset in the following structure:
   ```
   data/
   └── images/
       ├── class_1/
       │   ├── img1.png
       │   ├── img2.png
       ├── class_2/
       │   ├── img1.png
   ```

2. Update the `im_path` parameter in `default.yaml` to point to your dataset directory.

3. Adjust the following parameters in `default.yaml`:
   - **Number of channels** (e.g., RGB or grayscale).
   - **Image dimensions** (assume square images unless modified).

---

## Acknowledgments and Citations

This implementation is inspired by:
- The original paper: **[Denoising Diffusion Probabilistic Models](https://arxiv.org/abs/2006.11239)** by Jonathan Ho et al.
- U-Net architecture from the **[Stable Diffusion](https://github.com/CompVis/stable-diffusion)** project.

BibTeX citation:
```bibtex
@misc{ho2020denoising,
      title={Denoising Diffusion Probabilistic Models}, 
      author={Jonathan Ho and Ajay Jain and Pieter Abbeel},
      year={2020},
      eprint={2006.11239},
      archivePrefix={arXiv},
      primaryClass={cs.LG}
}
```

---



[def]: #usage